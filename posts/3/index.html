<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  
  
  <title>Manish Pandit&#39;s Blog</title>
  <meta name="description" content="A tech blog with gists, code, presentations, tutorials, and many goodies around programming, devops, cloud architectures, aws, google cloud platform, and infrastructure.">
  

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="https://lobster1234.github.io/posts/3/">
  
  
  <link rel="alternate" type="application/rss+xml" title="Manish Pandit&#39;s Blog" href="https://lobster1234.github.io/feed.xml">

  

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="lobster1234">
  <meta name="twitter:title" content="Manish Pandit&#39;s Blog">
  <meta name="twitter:description" content="A tech blog with gists, code, presentations, tutorials, and many goodies around programming, devops, cloud architectures, aws, google cloud platform, and infrastructure.">
  
    <meta name="twitter:creator" content="lobster1234">
  
  

  <script type="text/javascript">
  WebFontConfig = {
    google: { families: [ 'Bitter:400,700,400italic:latin' ] }
  };
  (function(d) {
    var wf = d.createElement('script'), s = d.scripts[0];
    wf.src = 'https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js';
    wf.async = true;
    s.parentNode.insertBefore(wf, s);
  })(document);
</script>

  
  <!-- Google Analytics -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-96931340-1', 'auto');
    ga('send', 'pageview');

  </script>


  <!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Manish Pandit’s Blog | A tech blog with gists, code, presentations, tutorials, and many goodies around programming, devops, cloud architectures, aws, google cloud platform, and infrastructure.</title>
<meta name="generator" content="Jekyll v3.4.3" />
<meta property="og:title" content="Manish Pandit’s Blog" />
<meta name="author" content="Manish Pandit" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A tech blog with gists, code, presentations, tutorials, and many goodies around programming, devops, cloud architectures, aws, google cloud platform, and infrastructure." />
<meta property="og:description" content="A tech blog with gists, code, presentations, tutorials, and many goodies around programming, devops, cloud architectures, aws, google cloud platform, and infrastructure." />
<link rel="canonical" href="https://lobster1234.github.io/posts/3/" />
<meta property="og:url" content="https://lobster1234.github.io/posts/3/" />
<meta property="og:site_name" content="Manish Pandit’s Blog" />
<link rel="prev" href="https://lobster1234.github.io/posts/2/" />
<link rel="next" href="https://lobster1234.github.io/posts/4/" />
<script type="application/ld+json">
{"description":"A tech blog with gists, code, presentations, tutorials, and many goodies around programming, devops, cloud architectures, aws, google cloud platform, and infrastructure.","author":{"@type":"Person","name":"Manish Pandit"},"@type":"WebPage","url":"https://lobster1234.github.io/posts/3/","headline":"Manish Pandit’s Blog","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">Home</a>

    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/">About</a>
      
        
        <a class="page-link" href="/archives/">Archives</a>
      
        
        <a class="page-link" href="https://www.twitter.com/lobster1234">Twitter</a>
      
    </nav>

  </div>

</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="home">

  

  

  <ul class="post-list">
    
      
      

      <li>
        <header class="post-header">
          <h1 class="post-title">
            <a class="post-link" href="/2017/12/03/run-tasks-with-aws-fargate-and-lambda/">Run tasks with AWS Fargate and Lambda</a>
          </h1>

          <p class="post-meta">Dec 3, 2017 •  •
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/categories/aws/">aws</a>,
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/categories/docker/">docker</a>,
      
    
      
    
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/categories/ecs/">ecs</a>
      
    
  


 •
  

</p>
        </header>

        <div class="post-content">
          <p>As with any other financial company, at <a href="https://www.marqeta.com">Marqeta</a>, we have a good number of batch jobs, which we are migrating over to <a href="https://aws.amazon.com/batch/">AWS Batch</a>. However, even in managed mode, AWS Batch needs us to define <a href="http://docs.aws.amazon.com/batch/latest/userguide/compute_environments.html">Compute Environments</a>, which are clusters of EC2 instances running ECS (and Docker) agents.</p>

<p><a href="https://aws.amazon.com/fargate/">AWS Fargate</a> was <a href="https://aws.amazon.com/blogs/compute/aws-fargate-a-product-overview/">announced</a> very recently at re:Invent 2017. Fargate adds a layer of abstraction on top of the Compute Environment, or the ECS Cluster. We no longer have to worry about the AMI, EC2 types, task placement, etc. In this post I cover the POC done to use Fargate over AWS Batch for batch processing, but this can also be used as a tutorial for running any type of tasks using Fargate. We create an ECS Task definition, a Fargate Cluster, and a Lambda to run the task using CloudWatch Event trigger.</p>

<p><img src="https://lobster1234.github.io/assets/fargate.png" alt="Fargate-0" /></p>


        </div>
        
          <p class="post-continue">
            <a href="/2017/12/03/run-tasks-with-aws-fargate-and-lambda/">Read on &rarr;</a>
          </p>
        
      </li>
    
      
      

      <li>
        <header class="post-header">
          <h1 class="post-title">
            <a class="post-link" href="/2017/11/17/immutable-aws-deployments-with-packer-and-jenkins/">Scale By the Bay - Immutable AWS Deployments with Packer and Jenkins</a>
          </h1>

          <p class="post-meta">Nov 17, 2017 •  •
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/categories/aws/">aws</a>,
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  
    
    
      
    
      
    
      
        <a href="/categories/presentations/">presentations</a>
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  


 •
  

</p>
        </header>

        <div class="post-content">
          <p>Slides from my talk at <a href="http://scale.bythebay.io/" target="_blank_">Scale By the Bay 2017</a>.</p>

<p>In this session I will talk about Immutable Deployments - which have become almost essential in the world of Microservices. As the frequency of deployments across multiple services increases with increasing granularity, it is critical to have repeatable, predictable and immutable deployments serving our customers. In practice, this is achieved via several DevOps tools. We will use Hashicorp <a href="https://www.packer.io">Packer</a> and Jenkins to build a simple, immutable AWS deployment of a <a href="https://github.com/lobster1234/helloworld-api">hello-world microservice</a>. Familiarity with AWS is recommended, but not required for this talk.</p>


        </div>
        
          <p class="post-continue">
            <a href="/2017/11/17/immutable-aws-deployments-with-packer-and-jenkins/">Read on &rarr;</a>
          </p>
        
      </li>
    
      
      

      <li>
        <header class="post-header">
          <h1 class="post-title">
            <a class="post-link" href="/2017/11/03/amazon-aurora-rds-notes/">Amazon Aurora Notes</a>
          </h1>

          <p class="post-meta">Nov 3, 2017 •  •
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/categories/aws/">aws</a>
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  


 •
  

</p>
        </header>

        <div class="post-content">
          <p>At <a href="https://www.marqeta.com">Marqeta</a>, we strive to continually evolve our platform to make it scalable and highly performant. We rely heavily on MySQL, and have many MySQL instances hosted across data centers, as well as on EC2s for various purposes. While refactoring some of our APIs, we thought of giving <a href="https://aws.amazon.com/rds/aurora/">Amazon Aurora</a> a try. Having heard about Aurora’s performance and high availability, this was definitely a great opportunity. Setting up a single node cluster (one <code class="highlighter-rouge">db.t2.small</code>) via the <a href="https://console.aws.amazon.com/rds/home?region=us-east-1">Console</a> was the first step. After a few clicks, we had our first Aurora Cluster running happily. Next step was to fire up our regression tests while pointing to a schema in Aurora. Our database fixtures worked like a charm, and we were surprised to see all of our (thousand+) tests pass - while we knew it was a MySQL <em>drop in replacement</em>, we still expected some drama. Great first impression!</p>


        </div>
        
          <p class="post-continue">
            <a href="/2017/11/03/amazon-aurora-rds-notes/">Read on &rarr;</a>
          </p>
        
      </li>
    
      
      

      <li>
        <header class="post-header">
          <h1 class="post-title">
            <a class="post-link" href="/2017/10/14/fan-out-with-sns-and-sqs-gotcha/">Fanout SNS-SQS Gotcha</a>
          </h1>

          <p class="post-meta">Oct 14, 2017 •  •
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/categories/aws/">aws</a>
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  


 •
  

</p>
        </header>

        <div class="post-content">
          <p>One of the very common architectural patterns is <em>fan-out</em> where an event is sent to multiple subscribers by a broker. An event can be like placing an order, which can then be handled by inventory service, record-keeping, as well as shipping service concurrently. These events can also be very frequent - like clickstreams, or search strings on a website. AWS allows for <a href="http://docs.aws.amazon.com/sns/latest/dg/SNS_Scenarios.html">fan-out architecture</a> with <a href="https://aws.amazon.com/sns/">SNS</a> topics, and <a href="https://aws.amazon.com/sqs/">SQS</a> queues. SQS queue(s) can subscribe to SNS topics and receive any message sent to the SNS topic(s). It is documented that <a href="http://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/FIFO-queues.html">FIFO queues</a> cannot be SNS subscribers <a href="https://forums.aws.amazon.com/thread.jspa?threadID=246962">here</a>.</p>

<p>However, as I recently found out, SSE-enabled SQS queues cannot subscribe to SNS either. While AWS stops us from subscribing a FIFO queue to SNS, <a href="https://aws.amazon.com/blogs/aws/new-server-side-encryption-for-amazon-simple-queue-service-sqs/">SSE-enabled queues</a> are allowed to subscribe, but they never get any events. The purpose of this post is to document this previously undocumented behavior.</p>


        </div>
        
          <p class="post-continue">
            <a href="/2017/10/14/fan-out-with-sns-and-sqs-gotcha/">Read on &rarr;</a>
          </p>
        
      </li>
    
      
      

      <li>
        <header class="post-header">
          <h1 class="post-title">
            <a class="post-link" href="/2017/10/10/logstash-with-aws-lambda/">Logstash logging with AWS Lambda</a>
          </h1>

          <p class="post-meta">Oct 10, 2017 •  •
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/categories/aws/">aws</a>,
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/categories/serverless/">serverless</a>
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  


 •
  

</p>
        </header>

        <div class="post-content">
          <p>Its a challenge to log messages with a Lambda, given that there is no server to run the agents or forwarders (splunk, filebeat, etc.) on. Here is a quick and easy tutorial to set up <a href="https://www.elastic.co/products">ELK</a> logging by writing directly to <a href="https://www.elastic.co/products/logstash">logstash</a> via the <a href="https://github.com/logstash/logstash-logback-encoder">TCP appender</a> and logback. This is for a Java/Maven based Lambda.</p>


        </div>
        
          <p class="post-continue">
            <a href="/2017/10/10/logstash-with-aws-lambda/">Read on &rarr;</a>
          </p>
        
      </li>
    
  </ul>

  
  <div class="pagination">
    
      <a class="previous" href="/posts/4/">&laquo; Older</a>
    

    
      <a class="next" href="/posts/2/">Newer &raquo;</a>
    
  </div>



</div>

      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    <p>
      

&copy; Manish Pandit - Powered by <a href="https://jekyllrb.com">Jekyll</a> &amp; <a href="https://github.com/yous/whiteglass">whiteglass</a> - Subscribe via <a href="https://lobster1234.github.io/feed.xml">RSS</a>

    </p>

  </div>

</footer>


  </body>

</html>
